### AI-Enhanced-Metal-coating-microscopic-Image-analysis

## Introduction
#### The AI-based Metal Coating Microscopic Image Analysis project focuses on automating the analysis of metal coating cross-sections to study the characteristics of undissolved and dissolved particles. This innova- tive solution integrates traditional image processing techniques with modern deep learning methodologies to provide an accurate, efficient, and scalable approach for analyzing microscopic images.The traditional image processing solution utilizes advanced techniques such as Contrast Limited Adaptive Histogram Equalization (CLAHE) and Histogram Equalization for image enhancement, along with super- pixel algorithms and denoising methods to address challenges like discontinuous boundaries and noise. These methods enable precise segmentation of undissolved white particles and the calculation of their area ratios, contributing to quality control and process optimization in metal coating applications.For the deep learning solution, a UNet segmentation model with ResNet as the backbone was trained using segmentation outputs generated by the traditional methods. This model enhances the automation process by accurately identifying and segmenting regions of interest in microscopic images. A user-friendly interface developed using Streamlit further enables detailed analyses such as calculating the fraction of melted and unmelted regions, the size and aspect ratio of unmelted pores, and their height and width.By combining traditional and modern approaches, this project offers a comprehensive tool for the metallur- gical department, automating the tedious and time-consuming analysis performed using ImageJ software. It significantly improves efficiency and accuracy in analyzing metal coatings, providing valuable insights for research, quality assurance, and industrial process optimization.

## Related Work
#### The analysis of microscopic images in material science has been extensively explored using both traditional image pro- cessing and deep learning techniques. Traditional methods, such as Histogram Equalization, CLAHE, and denoising filters, have proven effective in enhancing image quality and segmenting specific features like particles or pores in metal coatings. However, these methods often struggle with complex patterns, noise, and variability in datasets. Recent advancements in deep learning, particularly with architec- tures like UNet and ResNet backbones, have significantly improved segmentation accuracy and generalizability. These approaches excel in handling noisy and intricate images, offering robust solutions for tasks like material characteri- zation. This project builds upon these established techniques, integrating the strengths of both traditional and modern meth- ods to achieve superior segmentation and analysis outcomes tailored to metallurgical applications.

### IMAGE ENHANCEMENT TECHNIQUES
#### In the context of microscopic image analysis, enhancing image quality is crucial for improving the visibility of key features, particularly when dealing with low-contrast images. Two commonly used techniques for image quality enhance- ment are Contrast Limited Adaptive Histogram Equalization (CLAHE) and Histogram Equalization. Both methods are designed to enhance the contrast of images but operate in different ways, each with its unique advantages.

#### 1)	Histogram Equalization
#### Histogram Equalization is a fundamental image processing technique used to improve the contrast of an image. It works by redistributing the intensity values of the pix- els in an image so that they span the full range of possible values. This redistribution is done by modifying the cumulative distribution function (CDF) of the image histogram, leading to a more uniform intensity distribution.The histogram of an image represents the distribution of pixel intensity values.In a low-contrast image, the his- togram is often narrow and concentrated in a specific in- tensity range.Histogram Equalization spreads out the most frequent intensity values, thereby enhancing the contrast of the image.The transformation function is derived from the cumulative histogram, mapping the input intensity levels to new output levels that have a uniform distribution across the available intensity range.

#### Original Image
![image](https://github.com/user-attachments/assets/e5bb2823-d42f-4925-a7ed-35b6c457eb9e)  
#### Histogram Equalized Image
![image](https://github.com/user-attachments/assets/a36f88eb-97f3-4b60-ab2f-487bbba7b16b)

#### 2)Contrast Limited Adaptive Histogram Equalization 
#### CLAHE (Contrast Limited Adaptive Histogram Equaliza- tion) is an image enhancement technique that improves the contrast of images, particularly in cases where the lighting conditions are poor or the images have low contrast. CLAHEis an extension of the Adaptive Histogram Equalization (AHE) method, with an added step to prevent noise ampli- fication.
#### The CLAHE works by dividing images into small regions known as tiles or blocks (e.g., 8x8 or 16x16 pixels). His- togram equalization is applied to each tile independently. This redistributes the pixel intensity values to enhance lo- cal contrast within each tile. After processing all the tiles, CLAHE blends the enhanced regions together to avoid the blocky appearance that can occur at tile boundaries. This is done through bilinear interpolation, where pixel values at the boundaries of tiles are smoothly adjusted to maintain continuity across the entire image. Compared to Histogram equalization technique,CLAHE give good result to our data at clipLimit 10 by removing noises.

#### CLAHE applied  Image
![image](https://github.com/user-attachments/assets/04d6270d-4c61-42f4-8b19-e7834b8caffe)

#### SLIC Algorithm
#### The SLIC (Simple Linear Iterative Clustering) algorithm is a widely-used method for generating superpixels. It is known for its simplicity, efficiency, and ability to produce compact, uniform superpixels that adhere well to object boundaries in an image.SLIC typically operates in the CIELAB color space, which is designed to be more perceptually uniform than the RGB color space. This means that the Euclidean distance in CIELAB better corresponds to the perceived color difference. SLIC uses a modified k-means clustering approach to group pixels into superpixels. Unlike traditional k-means, SLIC incorporates spatial information to ensure that superpixels are spatially compact. The image is divided into a grid of initial cluster centers, spaced approximately S pixels apart, where S is the desired average size of the superpixels.
#### Output od SLIC algorithm
![image](https://github.com/user-attachments/assets/ff456b41-8d22-4cae-ab6e-e49bf95fb36f)

## METAL ANALYSIS PARAMETERS
#### Fraction of Melted Region
#### This represents the portion of the metal coating that has melted during the process, as determined by the segmentation of the melted regions in the microscopic image. It gives insights into the extent of melting in the coating, which can influence material properties.

#### Fraction of Unmelted Region
#### This represents the por- tion of the metal coating that has not melted, i.e., the unmelted particles or solidified areas. This metric helps assess the uniformity of the melting process and the presence of any defects.

#### Height and Width of Pores 
#### These dimensions repre- sent the size of the pores found in the coating. Pores may indicate defects in the material, affecting its strength and performance. Measuring their size is essential for quality control.
##### Height (h) = The vertical distance between the top and bottom points of a pore (in the segmented image).
##### Width (w) = The horizontal distance between the left and right points of a pore. These measurements can be calculated from the bounding box around each pore in the segmented image.

#### Aspect Ratio
#### The aspect ratio is the ratio of the width to the height of a pore. This parameter helps character- ize the shape of pores, distinguishing between circular, elliptical, or irregular shapes.

#### Area of Contour
#### The area of the contour corresponds to the size of an object (e.g., pore or particle) in the segmented image. This measurement helps quantify the extent of each particle or pore, providing insights into the coating’s texture and uniformity

## METHADOLOGY
#### The methodology for this project is divided into two key ap- proaches: Traditional Image Processing and Deep Learning- based Segmentation using U-Net. These methods are applied to analyze the metal coating cross-sections, segment the undissolved white particles, and perform various analyses, such as calculating the fraction of melted and unmelted regions, pore sizes, aspect ratios, and contours of the pores.

#### •	Traditional Image Processing Approach
#### – Step 1: Image Preprocessing
#### CLAHE (Contrast Limited Adaptive Histogram Equalization): Used to further improve the con- trast in local regions of the image, ensuring that the boundaries of small pores are well-defined and noise is reduced.
#### –	Step 2: Noise Reduction
#### Denoising Algorithms: Methods like Gaussian fil- tering or median filtering are applied to reduce im- age noise, ensuring that the segmentation process is not affected by irrelevant pixel variations.
#### –	Step 3: Superpixel Segmentation
#### SLIC Algorithm: Used to divide the image into small, uniform regions. This method helps address issues related to the discontinuity of boundaries in the image, as superpixels group pixels with similar properties, leading to smoother transitions between segments.
#### –	Step 4: Image Segmentation
#### Thresholding: A binary thresholding technique is applied to segment the image into melted and un- melted regions. This process is typically enhanced by analyzing pixel intensities.We used threshold value 140.

#### •	Deep Learning-Based Approach (U-Net Segmenta- tion)
#### –	Step 1: Dataset Preparation
#### Image and Mask Generation: The traditional image processing method’s output (segmentation masks) is used to create a training dataset for the U-Net model. These masks label the melted and unmelted regions.
#### –	Step 2: Model Architecture (U-Net with ResNet Backbone)
#### U-Net Architecture: The U-Net model, which con- sists of an encoder-decoder architecture, is used for image segmentation. The encoder captures context, and the decoder enables precise localization, mak- ing it ideal for tasks like the segmentation of pores and particles in metal coatings.
#### ResNet Backbone: The encoder part of the U-Net is enhanced with a pre-trained ResNet-50 backbone to improve feature extraction, especially for high- level features and to reduce model training time.
#### –	Step 3:Training the Model
#### Model Training: The U-Net model is trained us- ing the pre-processed images and masks generated from the traditional method. The training process uses the binary crossentropy and Intersection over Union (IoU) metrics as loss functions for accurate segmentation.
#### Augmentation: Data augmentation techniques like rotation, flipping, and zooming are used to increase the model’s generalization capabilities.
#### –	Step 4: Post-Processing
#### Segmentation Results: Once the model is trained, it is used to segment the input images. The output is a binary mask where the melted and unmelted regions are distinctly labeled.
#### –	Step 5: Performance Evaluation
#### Accuracy and IoU: The performance of the U-Net model is evaluated using accuracy and IoU (Inter- section over Union) scores. The model achieved an accuracy of 89% and an IoU of 79%, indicating good segmentation performance.
#### •	Software Development (Streamlit Interface)
#### –	Step 1: Interface Design
#### Streamlit Interface: A web-based interface is de- veloped using Streamlit to allow users to interact with the system. The interface enables users to upload microscopic images, run both the traditional and deep learning-based segmentation methods, and view the results.
#### –	Step 2: Result Visualization
#### Displaying Results: The software visualizes vari- ous analyses, including the fraction of melted and unmelted regions, pore size and aspect ratio, and the area of contours, using interactive plots and images.
#### –	Step 3: Analysis Outputs
#### Detailed Metrics: The interface calculates and displays detailed metrics, such as the fraction of melted regions, unmelted regions, pore size, aspect ratio, and area of contours. The user can easily interpret these metrics to assess the quality and uniformity of the metal coating. And allowed to download as Excel format.

## RESULTS
#### Original Microscopic metal coating Image
![image](https://github.com/user-attachments/assets/85ff736f-ac81-40e0-9b9d-c204fe06fe70)

#### Basically the dark particles the powder coating melted region and white circular pores are unmelted regions

#### Segmentation from UNet Model
![image](https://github.com/user-attachments/assets/8ef5a997-2413-429e-8796-dee2a2558857)

#### Drawn a boundary around Segmented pores
![image](https://github.com/user-attachments/assets/ae48e9c9-d970-4c59-b6e3-53969954e99a)







